#!/usr/bin/env python3
"""
Update Odoo module

This script proceed to a manual update of one or more Odoo modules in the database.

Usage:
  odoo-update [--help] <module>

Options:
  -h, --help           Show this screen and exit.
  <module>             Module list to update separated by comma.
                       Use 'all' as module name to update all modules at once.
"""
import os
import subprocess
import sys

import docopt

argv = sys.argv[1:] or ["-h"]
args = docopt.docopt(__doc__, argv=argv)

dbname = os.environ.get("PGDATABASE")

cmd = [
    "odoo",
    "-u",
    args["<module>"],
    "--stop-after-init",
    "--no-http",
]

if dbname:
    cmd += ["-d", dbname]

subprocess.run(cmd)
